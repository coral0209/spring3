<?xml version="1.0" encoding="UTF-8"?>
	
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	

<mapper namespace = "recipe">



 <!-- 레시피 전체 조회 param : 없음 -->
 
 	<select id="viewAllRecipe" resultType="recipeVo" >
		SELECT *
		FROM recipeb
		order by rb_date desc
 	</select>
 
 
 <!-- 레시피 글 하나 등록  -->
	<insert id="recipeInsert" parameterType="recipeVo" >
		 INSERT INTO recipeb values 
 		(recipeb_seq.nextval, #{id, jdbcType=VARCHAR} , #{rb_content, jdbcType=VARCHAR} , 0 , null, #{rb_title, jdbcType=VARCHAR} , #{file_path, jdbcType=VARCHAR} , #{filename, jdbcType=VARCHAR} , sysdate)
	</insert> 
 
 
 <!-- 레시피 글 하나 삭제-->

	<delete id="recipeDelete" parameterType="String">
		DELETE recipeb WHERE rb_cod = #{rb_cod} 
	</delete>
	
	


	
	
 <!-- 레시피게시판 코드1개를 받아서 클릭한 레시피의  상세페이지에 내용 입력을 위함 
 param : 클릭한 그림의 1개의 레시피게시판코드  결과값 : 1행 전부 데이터 -->
 
 	<select id="viewOneRecipe" parameterType="String" resultType="recipeVo" >
 		SELECT *
		FROM recipeb
 		WHERE rb_cod = #{rb_cod}
 	</select>

<!-- 레시피 상세페이지에서 댓글 불러오기 param : 상위 레시피 결과는 상위레시피에 속하는 모든 댓글List 형식-->
	<select id="viewRecipeReply" parameterType="String" resultType="recipereviewVo" >
	
		SELECT *
		FROM recipea 
		WHERE rb_cod = #{rb_cod}
		ORDER BY ba_date desc
	
	</select>	
	
	
<!-- 레시피 신고하면 변함  -->

	<update id="alertRecipe" parameterType="String" >

	update recipeb set rb_alert = 'x' where rb_cod = #{rb_cod} 
	
	</update> 

<!-- 레시피 상세페이지에서 댓글 등록하기 -->

	<insert id="recipeReplyinsert" parameterType="recipereviewVo">
	INSERT INTO recipea values 
	( recipereview_seq.nextval   , #{rb_cod, jdbcType=VARCHAR} , #{id, jdbcType=VARCHAR} , #{ba_content , jdbcType=VARCHAR} , sysdate)
	
	
	</insert>
	
	
<!-- 레시피 댓글 삭제 -->
	<delete id="deleteReply" parameterType="String">
	
		delete recipea where ba_cod = #{ba_cod} 
	
	</delete>

<!--  레시피 댓글 수정 -->	
	<update id="updateReply" parameterType="recipereviewVo">
	
		update recipea set ba_content = #{ba_content} ,  ba_date = sysdate where ba_cod = #{ba_cod} 
	
	</update>	
	
	<!-- 레시피 글 하나 삭제할때 관련된 댓글도 모두 삭제 -->

	<delete id="deleteAllReply" parameterType="String" >
	
	DELETE recipea where rb_cod =  #{b_cod} 
	
	
	</delete>
	
	 <!-- 레시피 글 수정 -->
 
 	<update id="RecipeUpdate" parameterType="recipeVo" >
 		update recipeb set rb_content = #{rb_content}  where rb_cod = #{rb_cod} 
 	</update>	
 	

	


</mapper>